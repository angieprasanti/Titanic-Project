//male chart data
const maleChartData = {
    labels: [ 
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        50,
        51,
        52,
        53,
        54,
        55,
        56,
        57,
        58,
        59,
        60,
        61,
        62,
        63,
        64,
        65,
        66,
        67,
        68,
        69,
        70,
        71,
        72,
        73,
        74,
        75,
        76,
        77,
        78,
        79,
        80
        ],
        // below is the male survival stat
    datasets: [{
        label: 'Survived',
        borderWidth: 1,
        backgroundColor: '#587B7F',
        data: [
            8,
            1,
            4,
            2,
            0,
            1,
            0,
            1,
            2,
            0,
            1,
            1,
            0,
            0,
            0,
            1,
            1,
            1,
            2,
            3,
            1,
            1,
            1,
            1,
            4,
            3,
            6,
            2,
            3,
            1,
            3,
            7,
            0,
            2,
            3,
            4,
            1,
            1,
            1,
            1,
            0,
            3,
            0,
            1,
            2,
            0,
            0,
            3,
            2,
            1,
            1,
            1,
            0,
            0,
            0,
            1,
            0,
            0,
            0,
            1,
            0,
            1,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            1
            ]
    }, {
        //below is the male death stat
        label: 'Died',
        borderWidth: 1,
        backgroundColor: '#E94F37',
        data: [
            -2,
            -3,
            0,
            -3,
            0,
            0,
            -2,
            -1,
            -2,
            -1,
            -2,
            0,
            0,
            -2,
            -1,
            -10,
            -6,
            -12,
            -16,
            -10,
            -16,
            -14,
            -9,
            -13,
            -14,
            -10,
            -6,
            -16,
            -10,
            -13,
            -7,
            -8,
            -9,
            -9,
            -7,
            -11,
            -4,
            -5,
            -7,
            -6,
            -2,
            -7,
            -3,
            -5,
            -4,
            -3,
            -7,
            -2,
            -2,
            -4,
            -5,
            -3,
            0,
            -5,
            -1,
            -2,
            -1,
            -2,
            -2,
            -2,
            -3,
            -2,
            0,
            -2,
            -3,
            -1,
            0,
            0,
            0,
            -2,
            -2,
            0,
            0,
            -1,
            0
            ]
    }]

};

// female chart data
const femaleChartData = {
    labels: [ 
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        15,
        16,
        17,
        18,
        19,
        20,
        21,
        22,
        23,
        24,
        25,
        26,
        27,
        28,
        29,
        30,
        31,
        32,
        33,
        34,
        35,
        36,
        37,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        49,
        50,
        51,
        52,
        53,
        54,
        55,
        56,
        57,
        58,
        59,
        60,
        61,
        62,
        63,
        64
        ],
        // below is the female survival stat
    datasets: [{
        label: 'Survived',
        borderWidth: 1,
        backgroundColor: '#587B7F',
        data: [
            2,
            1,
            5,
            4,
            1,
            1,
            1,
            0,
            0,
            0,
            0,
            2,
            3,
            4,
            5,
            5,
            8,
            7,
            0,
            4,
            10,
            4,
            14,
            2,
            3,
            5,
            5,
            5,
            9,
            5,
            2,
            6,
            4,
            8,
            7,
            0,
            4,
            4,
            5,
            2,
            3,
            1,
            2,
            3,
            0,
            1,
            3,
            2,
            4,
            1,
            2,
            1,
            3,
            1,
            1,
            0,
            3,
            0,
            1,
            0,
            1,
            2
            ]
    }, {
        //below is the female death stat
        label: 'Died',
        borderWidth: 1,
        backgroundColor: '#E94F37',
        data: [
            0,
            -3,
            -1,
            0,
            0,
            -1,
            0,
            0,
            -3,
            -1,
            -1,
            0,
            0,
            -1,
            0,
            -1,
            -1,
            -5,
            0,
            -2,
            -3,
            -2,
            -1,
            -2,
            -3,
            -2,
            -1,
            -2,
            -2,
            -2,
            -2,
            -1,
            0,
            0,
            0,
            0,
            -1,
            -1,
            -2,
            -1,
            -2,
            0,
            -1,
            -1,
            -3,
            0,
            -1,
            -1,
            0,
            -1,
            0,
            0,
            0,
            0,
            0,
            0,
            -1,
            0,
            0,
            0,
            0,
            0,
            0,
            0
            ]
    }]

};

// male chart statistic.
var ctx = document.getElementById('myChart').getContext('2d');
new Chart(ctx, {
    type: 'bar',
    data: maleChartData,
    options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
            labels: {
                fontSize: 20,
                fontColor: '#090909',
                fontFamily: 'IM fell english'
            },
            position: 'top',
        },
        title: {
            display: true,
            text: 'Male Survival Statistic',
            fontSize: 20,
            fontColor: '#090909',
            fontFamily: 'IM fell english'
        },
        tooltips: {
            callbacks: {
                label: function(tooltipItem, data) {
                    var value = tooltipItem.yLabel;
                    return value < 0 ? -value : value;
                }
            }
        },
        scales: {
            yAxes: [{
                stacked: true,
                scaleLabel: {
                    fontSize: 20,
                    fontColor: '#090909',
                    fontFamily: 'IM fell english',
                    display: true,
                    labelString: '<- Died - Survived ->'},
              stacked: false,
              ticks: {
                fontSize: 20,
                fontColor: '#090909',
                fontFamily: 'IM fell english',
                max: 16,
                min: -16,
                callback: function(value, index, values) {
                  return value < 0 ? -value : value;
                }
              }
            }],
            xAxes: [{
                stacked: true,
                scaleLabel: {
                    fontSize:20,
                    fontColor: '#090909',
                    fontFamily: 'IM fell english',
                    display: true,
                    labelString: 'Age'
                },
                ticks: {  
                    fontSize: 20,
                    fontColor: '#090909',
                    fontFamily: 'IM fell english',
                }
            }],
        }
    }
});

//female statistic

var ctx2 = document.getElementById('myChart2').getContext('2d');
new Chart(ctx2, {
    type: 'bar',
    data: femaleChartData,
    options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
            labels: {
                fontSize: 20,
                fontColor: '#090909',
                fontFamily: 'IM fell english'
            },
            position: 'top',
        },
        title: {
            display: true,
            text: 'Female Survival Statistic',
            fontSize: 20,
            fontColor: '#090909',
            fontFamily: 'IM fell english'
        },
        tooltips: {
            callbacks: {
                label: function(tooltipItem, data) {
                    var value = tooltipItem.yLabel;
                    return value < 0 ? -value : value;
                }
            }
        },
        scales: {
            yAxes: [{
                stacked: true,
                scaleLabel: {
                    fontSize: 20,
                    fontColor: '#090909',
                    fontFamily: 'IM fell english',
                    display: true,
                    labelString: '<- Died - Survived ->'},
                    stacked: false,
                    ticks: {
                        fontSize: 20,
                        fontColor: '#090909',
                        fontFamily: 'IM fell english',
                    min: -14,
                callback: function(value, index, values) {
                  return value < 0 ? -value : value;
                }
              }
            }],
            xAxes: [{
                stacked: true,
                scaleLabel: {
                    display: true,
                    labelString: 'Age',
                    fontSize: 20,
                    fontColor: '#090909',
                    fontFamily: 'IM fell english'
 
                },
                ticks: {  
                    fontSize: 20,
                    fontColor: '#090909',
                    fontFamily: 'IM fell english',
                }
            }],
        }
    }
});


            function addData(chart, label, color, data) {
                chart.data.datasets.push({
                label: label,
              backgroundColor: color,
              data: data
            });
            chart.update();
        }





//fake data
const	age1	=	0.01
const	age2	=	0.02
const	age3	=	0.03
const	age4	=	0.04
const	age5	=	0.05
const	age6	=	0.06
const	age7	=	0.07
const	age8	=	0.08
const	age9	=	0.09
const	age10	=	0.1
const	age11	=	0.11
const	age12	=	0.12
const	age13	=	0.13
const	age14	=	0.14
const	age15	=	0.15
const	age16	=	0.16
const	age17	=	0.17
const	age18	=	0.18
const	age19	=	0.19
const	age20	=	0.2
const	age21	=	0.21
const	femaleAge22	=	0.22
const  femaleAge23	=	50
const	age24	=	0.24
const	age25	=	0.25
const	age26	=	0.26
const	age27	=	0.27
const	age28	=	0.28
const	age29	=	0.29
const	age30	=	0.3
const	age31	=	0.31
const	age32	=	0.32
const	age33	=	0.33
const	age34	=	0.34
const	age35	=	0.35
const	age36	=	0.36
const	age37	=	0.37
const	age38	=	0.38



// the game is below
const startButton = document.getElementById('startButton');
const game = document.getElementById('sinkOrSwim');
const ageInput = document.getElementById('ageInput');
const sexInput = document.getElementById('sexInput');
const startGameMusic = document.getElementById('startGameMusic');
const titleScreenMusic = document.getElementById('titleScreenMusic');
let userInputSex = document.getElementById('sexInput');
let userInputAge = document.getElementById('ageInput');
const buttonMusic = document.getElementById('buttonMusic');
var probabilityResult = document.getElementById('probabilityResult');
let isStart = false;
let i = 0;
var value = 'Based on the data we have received.... your chance of survival is';


function typeWriter() {
    if (i < value.length) {
        probabilityResult.innerHTML += value.charAt(i);
        i++;
        setTimeout(typeWriter, 40);
      }
    
}



//the button function

function started() {
    if(isStart === false) {
        ageInput.style.visibility = "visible";
        sexInput.style.visibility = "visible";
        buttonMusic.play();
        setTimeout(function() {titleScreenMusic.play();}, 500)
        isStart = 1;
    } else if (isStart == 1) {
        buttonMusic.play();
        ageInput.style.display = "none";
        sexInput.style.display = "none";
        typeWriter();
        setTimeout(function() {document.getElementById('result').innerHTML = eval(userInputSex.value + 'Age' + userInputAge.value) + '%' + ' <br> <br> Would you like to continue?'},2750)
        isStart = 2;
    } else if (isStart == 2) {
        buttonMusic.play();
        setTimeout(function() {startGameMusic.play();}, 500)
        titleScreenMusic.pause();
        startButton.style.visibility = "hidden";
        document.getElementById('result').style.visibility = "hidden";
        probabilityResult.style.visibility = "hidden";
        survivalAction(survivalResult());
        isStart = 3;
    }
}



//the calculation whether user survived or died.
function survivalResult() {
  const random = Math.floor(Math.random() * 101)
  if (random >= 0 && random <= eval(userInputSex.value + 'Age' + userInputAge.value)) {
    return 'survived'
  } else {
    return 'died'
  }
}

// the act on whether ship sink or swim
function survivalAction (value) {
 if (value == 'survived') {
     alert('survived')
 } else if (value == 'died') {
     alert('died');
 }
}



//eventHandler





